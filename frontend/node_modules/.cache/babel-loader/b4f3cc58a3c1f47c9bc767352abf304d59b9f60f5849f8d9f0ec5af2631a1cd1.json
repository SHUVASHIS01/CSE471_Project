{"ast":null,"code":"var _jsxFileName = \"E:\\\\CSE471JOBPortal_M3\\\\CSE471JOBPortal_M3\\\\frontend\\\\src\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useState, useContext, useEffect, useRef } from 'react';\nimport { authAPI } from './api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext();\nexport const AuthProvider = ({\n  children\n}) => {\n  _s();\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [showSessionWarning, setShowSessionWarning] = useState(false);\n  useEffect(() => {\n    const checkAuth = async () => {\n      try {\n        const response = await authAPI.getProfile();\n        setUser(response.data.user);\n      } catch (err) {\n        setUser(null);\n      } finally {\n        setLoading(false);\n      }\n    };\n    checkAuth();\n  }, []);\n\n  /**\r\n   * Auto-save user's current work/session state before logout\r\n   */\n  const saveUserSessionState = React.useCallback(async () => {\n    try {\n      if (!user) return;\n      console.log('[Session Auto-Save] Saving user session state');\n\n      // Save current form data if any (you can expand this based on your needs)\n      const sessionData = {\n        lastPageVisited: window.location.pathname,\n        timestamp: new Date().toISOString(),\n        savedJobs: localStorage.getItem('savedJobs') || null\n        // Add more session data as needed\n      };\n\n      // Store in browser storage for next login\n      sessionStorage.setItem(`session_${user.id}`, JSON.stringify(sessionData));\n      console.log('[Session Auto-Save] Session state saved successfully');\n    } catch (err) {\n      console.error('[Session Auto-Save] Error saving session state:', err);\n    }\n  }, [user]);\n\n  /**\r\n   * Handle session warning - show warning dialog\r\n   */\n  const handleSessionWarning = React.useCallback(async () => {\n    console.log('[AuthContext] ⚠️ WARNING - Session expiring, showing dialog');\n    setShowSessionWarning(true);\n  }, []);\n\n  /**\r\n   * Handle session timeout - auto-logout with data save\r\n   */\n  const handleSessionTimeout = React.useCallback(async () => {\n    console.log('[Session Timeout] Session expired, initiating auto-logout');\n    try {\n      // Auto-save work before logout\n      await saveUserSessionState();\n\n      // Clear user state\n      setUser(null);\n      setShowSessionWarning(false);\n\n      // Attempt logout\n      try {\n        await authAPI.logout();\n      } catch (logoutErr) {\n        console.error('[Session Timeout] Error during logout API call:', logoutErr);\n      }\n\n      // Show alert before redirecting\n      alert('Your session has expired due to inactivity. Your work has been saved. Please log in again.');\n\n      // Redirect to login page\n      window.location.href = '/login';\n    } catch (err) {\n      console.error('[Session Timeout] Error during session timeout:', err);\n      setUser(null);\n      window.location.href = '/login';\n    }\n  }, [saveUserSessionState]);\n\n  /**\r\n   * Handle continue session button click\r\n   */\n  const handleContinueSession = React.useCallback(() => {\n    console.log('[Session Warning] User clicked Continue Session');\n    setShowSessionWarning(false);\n  }, []);\n  const register = async (name, email, password, role, companyId = null) => {\n    const response = await authAPI.register(name, email, password, role, companyId);\n    setUser(response.data.user);\n    return response.data;\n  };\n  const login = async (email, password, additionalData = {}) => {\n    const response = await authAPI.login(email, password, additionalData);\n    setUser(response.data.user);\n    return response.data;\n  };\n  const logout = async () => {\n    await saveUserSessionState();\n    await authAPI.logout();\n    setUser(null);\n  };\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      user,\n      loading,\n      register,\n      login,\n      logout,\n      showSessionWarning,\n      setShowSessionWarning,\n      handleContinueSession,\n      handleSessionTimeout,\n      saveUserSessionState\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 5\n  }, this);\n};\n_s(AuthProvider, \"dZcv/W+RaSaOoDuIl0l2ALw9Txg=\");\n_c = AuthProvider;\nexport const useAuth = () => {\n  _s2();\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within AuthProvider');\n  }\n  return context;\n};\n_s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","useRef","authAPI","jsxDEV","_jsxDEV","AuthContext","AuthProvider","children","_s","user","setUser","loading","setLoading","showSessionWarning","setShowSessionWarning","checkAuth","response","getProfile","data","err","saveUserSessionState","useCallback","console","log","sessionData","lastPageVisited","window","location","pathname","timestamp","Date","toISOString","savedJobs","localStorage","getItem","sessionStorage","setItem","id","JSON","stringify","error","handleSessionWarning","handleSessionTimeout","logout","logoutErr","alert","href","handleContinueSession","register","name","email","password","role","companyId","login","additionalData","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuth","_s2","context","Error","$RefreshReg$"],"sources":["E:/CSE471JOBPortal_M3/CSE471JOBPortal_M3/frontend/src/AuthContext.js"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect, useRef } from 'react';\r\nimport { authAPI } from './api';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [user, setUser] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [showSessionWarning, setShowSessionWarning] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkAuth = async () => {\r\n      try {\r\n        const response = await authAPI.getProfile();\r\n        setUser(response.data.user);\r\n      } catch (err) {\r\n        setUser(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    checkAuth();\r\n  }, []);\r\n\r\n  /**\r\n   * Auto-save user's current work/session state before logout\r\n   */\r\n  const saveUserSessionState = React.useCallback(async () => {\r\n    try {\r\n      if (!user) return;\r\n      \r\n      console.log('[Session Auto-Save] Saving user session state');\r\n      \r\n      // Save current form data if any (you can expand this based on your needs)\r\n      const sessionData = {\r\n        lastPageVisited: window.location.pathname,\r\n        timestamp: new Date().toISOString(),\r\n        savedJobs: localStorage.getItem('savedJobs') || null,\r\n        // Add more session data as needed\r\n      };\r\n      \r\n      // Store in browser storage for next login\r\n      sessionStorage.setItem(`session_${user.id}`, JSON.stringify(sessionData));\r\n      \r\n      console.log('[Session Auto-Save] Session state saved successfully');\r\n    } catch (err) {\r\n      console.error('[Session Auto-Save] Error saving session state:', err);\r\n    }\r\n  }, [user]);\r\n\r\n  /**\r\n   * Handle session warning - show warning dialog\r\n   */\r\n  const handleSessionWarning = React.useCallback(async () => {\r\n    console.log('[AuthContext] ⚠️ WARNING - Session expiring, showing dialog');\r\n    setShowSessionWarning(true);\r\n  }, []);\r\n\r\n  /**\r\n   * Handle session timeout - auto-logout with data save\r\n   */\r\n  const handleSessionTimeout = React.useCallback(async () => {\r\n    console.log('[Session Timeout] Session expired, initiating auto-logout');\r\n    try {\r\n      // Auto-save work before logout\r\n      await saveUserSessionState();\r\n      \r\n      // Clear user state\r\n      setUser(null);\r\n      setShowSessionWarning(false);\r\n      \r\n      // Attempt logout\r\n      try {\r\n        await authAPI.logout();\r\n      } catch (logoutErr) {\r\n        console.error('[Session Timeout] Error during logout API call:', logoutErr);\r\n      }\r\n      \r\n      // Show alert before redirecting\r\n      alert('Your session has expired due to inactivity. Your work has been saved. Please log in again.');\r\n      \r\n      // Redirect to login page\r\n      window.location.href = '/login';\r\n    } catch (err) {\r\n      console.error('[Session Timeout] Error during session timeout:', err);\r\n      setUser(null);\r\n      window.location.href = '/login';\r\n    }\r\n  }, [saveUserSessionState]);\r\n\r\n  /**\r\n   * Handle continue session button click\r\n   */\r\n  const handleContinueSession = React.useCallback(() => {\r\n    console.log('[Session Warning] User clicked Continue Session');\r\n    setShowSessionWarning(false);\r\n  }, []);\r\n\r\n  const register = async (name, email, password, role, companyId = null) => {\r\n    const response = await authAPI.register(name, email, password, role, companyId);\r\n    setUser(response.data.user);\r\n    return response.data;\r\n  };\r\n\r\n  const login = async (email, password, additionalData = {}) => {\r\n    const response = await authAPI.login(email, password, additionalData);\r\n    setUser(response.data.user);\r\n    return response.data;\r\n  };\r\n\r\n  const logout = async () => {\r\n    await saveUserSessionState();\r\n    await authAPI.logout();\r\n    setUser(null);\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={{ \r\n      user, \r\n      loading, \r\n      register, \r\n      login, \r\n      logout,\r\n      showSessionWarning,\r\n      setShowSessionWarning,\r\n      handleContinueSession,\r\n      handleSessionTimeout,\r\n      saveUserSessionState\r\n    }}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useAuth = () => {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within AuthProvider');\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}